<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:PetInsulinTracker.ViewModels"
             xmlns:mi="http://www.aathifmahir.com/dotnet/2022/maui/icons"
             x:Class="PetInsulinTracker.Views.SharePage"
             x:DataType="vm:ShareViewModel"
             Title="Share Pet"
             BackgroundColor="{DynamicResource PageBackground}">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="16">

            <!-- Share Code Ticket -->
            <Label Text="SHARE CODE" Style="{StaticResource OverlineStyle}" />

            <Border Style="{StaticResource CardStyleElevated}"
                    Padding="24"
                    IsVisible="{Binding ShareCode, Converter={StaticResource IsNotNullOrEmptyConverter}}">
                <VerticalStackLayout Spacing="12" HorizontalOptions="Center">
                    <Label Text="Your pet's share code" Style="{StaticResource SubtleTextStyle}"
                           HorizontalOptions="Center" />
                    <Border BackgroundColor="{DynamicResource CurrentSurface}"
                            StrokeThickness="2"
                            Stroke="{DynamicResource CurrentPrimary}"
                            StrokeShape="RoundRectangle 12"
                            Padding="24,16"
                            HorizontalOptions="Center">
                        <Label Text="{Binding ShareCode}" FontSize="36" FontFamily="OpenSansSemibold"
                               LetterSpacing="6" HorizontalOptions="Center"
                               TextColor="{DynamicResource CurrentPrimary}"
                               SemanticProperties.Description="Share code" />
                    </Border>
                    <Button Text="Copy Code" Command="{Binding CopyShareCodeCommand}"
                            Style="{StaticResource QuickActionButtonStyle}"
                            HorizontalOptions="Center" />
                    <Label Text="Share this code with family members or pet sitters so they can view and update your pet's records."
                           Style="{StaticResource SubtleTextStyle}" FontSize="13"
                           HorizontalOptions="Center" HorizontalTextAlignment="Center" />
                </VerticalStackLayout>
            </Border>

            <Button Text="Generate Share Code"
                    Command="{Binding GenerateShareCodeCommand}"
                    IsEnabled="{Binding IsGenerating, Converter={StaticResource InvertedBoolConverter}}"
                    Style="{StaticResource PrimaryButtonStyle}"
                    HorizontalOptions="Fill" />

            <!-- Redeem Code -->
            <BoxView Style="{StaticResource DividerStyle}" Margin="0,8" />
            <Label Text="IMPORT A PET" Style="{StaticResource OverlineStyle}" />

            <Border Style="{StaticResource CardStyle}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Enter a share code to import someone else's pet:"
                           Style="{StaticResource SubtleTextStyle}" FontSize="14" />
                    <Entry Text="{Binding RedeemCode}" Placeholder="e.g., ABC123"
                           CharacterSpacing="4" FontSize="22" FontFamily="OpenSansSemibold"
                           HorizontalTextAlignment="Center" MaxLength="6" />
                    <Button Text="Import Pet" Command="{Binding RedeemShareCodeCommand}"
                            IsEnabled="{Binding IsRedeeming, Converter={StaticResource InvertedBoolConverter}}"
                            Style="{StaticResource SecondaryButtonStyle}"
                            HorizontalOptions="Fill" />
                </VerticalStackLayout>
            </Border>

            <!-- Status -->
            <Label Text="{Binding StatusMessage}" FontSize="14" FontFamily="OpenSansSemibold"
                   HorizontalTextAlignment="Center"
                   TextColor="{DynamicResource CurrentPrimary}"
                   IsVisible="{Binding StatusMessage, Converter={StaticResource IsNotNullOrEmptyConverter}}" />

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
